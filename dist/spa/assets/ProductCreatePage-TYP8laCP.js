import{Q as C,a as m}from"./QForm-Bb-uwiC3.js";import{Q as b,a as h,b as F}from"./QToggle-OedJx1bz.js";import{Q as q}from"./QImg-BF2cFclf.js";import{i as S,Q as R}from"./use-quasar-Dx-yCSXX.js";import{a as A,r as s,p as B,f as _,o as c,w as p,n as r,g as t,a2 as E,i as Q,a0 as N,F as I,k as L,Q as x}from"./index-DRg9g1vX.js";import{Q as M}from"./QCardSection-0caMwbFv.js";import{Q as D}from"./QCard-CnWs91_S.js";import{Q as G}from"./QPage-Bly9c7C9.js";import{u as H}from"./productStore-CYCjIWKg.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-key-composition-v6eh3HGp.js";import"./use-dark-BA2Gvzb3.js";import"./focus-manager-zjdVGI5d.js";import"./QDialog-Cwu0fu7V.js";import"./selection-n5EXbK2P.js";import"./use-timeout-8iYzss33.js";import"./format-CDN244_G.js";import"./QTooltip-Bl8pvChp.js";const T={class:"q-pa-md"},$={class:"row q-col-gutter-md"},j={class:"col-xs-12 col-md-8"},z={key:0,class:"q-mt-sm"},J={class:"col-xs-12 col-md-4"},K={class:"q-mt-xl"},W={class:"q-mt-md row q-gutter-md"},X={class:"q-mt-lg"},Y={__name:"ProductCreatePage",setup(Z){const V=S(),P=A(),v=H(),a=s({name:"",reference:"",description:"",category_id:null,price:0,stock_quantity:0,is_active:!0}),u=s(null),d=s(null),i=s([]),n=s([]),y=s([]),g=s(!1);B(async()=>{await v.fetchCategories(),y.value=v.categories.map(o=>({label:o.name,value:o.id}))});const w=o=>{if(u.value=o,o){const l=new FileReader;l.onload=e=>{d.value=e.target.result},l.readAsDataURL(o)}else d.value=null},U=o=>{i.value=o,o&&o.length>0?(n.value=[],o.forEach(l=>{const e=new FileReader;e.onload=f=>{n.value.push(f.target.result)},e.readAsDataURL(l)})):n.value=[]},k=async()=>{g.value=!0;try{await v.createProduct(a.value,u.value,i.value),V.notify({color:"positive",message:"Producto creado exitosamente.",icon:"check_circle"}),P.push({name:"product-list"})}catch(o){console.error("Error al crear el producto:",o),V.notify({color:"negative",message:"Hubo un error al crear el producto. "+(o.message||"Por favor, intente de nuevo."),icon:"error"})}finally{g.value=!1}};return(o,l)=>(c(),_(G,{padding:""},{default:p(()=>[r("div",T,[l[10]||(l[10]=r("div",{class:"text-h4 q-mb-md"},"Crear Nuevo Producto",-1)),t(D,null,{default:p(()=>[t(M,null,{default:p(()=>[t(C,{onSubmit:E(k,["prevent"])},{default:p(()=>[r("div",$,[r("div",j,[t(m,{modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.name=e),label:"Nombre del Producto",filled:"",rules:[e=>!!e||"El nombre es requerido"]},null,8,["modelValue","rules"]),t(m,{modelValue:a.value.reference,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.reference=e),label:"Referencia",filled:"",class:"q-mt-md"},null,8,["modelValue"]),t(b,{modelValue:u.value,"onUpdate:modelValue":[l[2]||(l[2]=e=>u.value=e),w],label:"Avatar del Producto",filled:"",accept:"image/*",capture:"camera",class:"q-mt-md",style:{"max-width":"300px"}},null,8,["modelValue"]),d.value?(c(),Q("div",z,[t(q,{src:d.value,style:{width:"120px",height:"120px","border-radius":"4px"}},null,8,["src"])])):N("",!0),t(h,{modelValue:a.value.description,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.description=e),label:"Descripción",filled:"",class:"q-mt-md","min-height":"150px"},null,8,["modelValue"])]),r("div",J,[t(R,{modelValue:a.value.category_id,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value.category_id=e),options:y.value,label:"Categoría","emit-value":"","map-options":"",filled:"",rules:[e=>e!==null||"La categoría es requerida"]},null,8,["modelValue","options","rules"]),t(m,{modelValue:a.value.price,"onUpdate:modelValue":l[5]||(l[5]=e=>a.value.price=e),modelModifiers:{number:!0},label:"Precio",type:"number",step:"0.01",filled:"",class:"q-mt-md"},null,8,["modelValue"]),t(m,{modelValue:a.value.stock_quantity,"onUpdate:modelValue":l[6]||(l[6]=e=>a.value.stock_quantity=e),modelModifiers:{number:!0},label:"Cantidad en Stock",type:"number",filled:"",class:"q-mt-md"},null,8,["modelValue"]),t(F,{modelValue:a.value.is_active,"onUpdate:modelValue":l[7]||(l[7]=e=>a.value.is_active=e),label:"Producto Activo",class:"q-mt-md"},null,8,["modelValue"])])]),r("div",K,[l[9]||(l[9]=r("div",{class:"text-h6"},"Galería de Imágenes",-1)),t(b,{modelValue:i.value,"onUpdate:modelValue":[l[8]||(l[8]=e=>i.value=e),U],label:"Añadir imágenes a la galería",multiple:"",accept:"image/*",filled:"",capture:"camera",style:{"max-width":"400px"}},null,8,["modelValue"]),r("div",W,[(c(!0),Q(I,null,L(n.value,(e,f)=>(c(),_(q,{key:f,src:e,class:"gallery-thumbnail"},null,8,["src"]))),128))])]),r("div",X,[t(x,{label:"Guardar Producto",type:"submit",color:"primary",loading:g.value},null,8,["loading"]),t(x,{label:"Cancelar",color:"grey",class:"q-ml-sm",to:{name:"product-list"}})])]),_:1})]),_:1})]),_:1})])]),_:1}))}},ye=O(Y,[["__scopeId","data-v-dcf771c0"]]);export{ye as default};
