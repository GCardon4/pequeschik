import{az as C,a as h,r as s,q as F,f as b,o as m,w as c,p as r,g as t,ag as S,ak as B,ah as R,i as q,ae as A,ai as p,aB as E,F as N,k as I,Q as _}from"./index-CEvKOOos.js";import{Q as x,a as L}from"./QEditor-Ch4aDXiJ.js";import{Q}from"./QImg-C2tOMvLs.js";import{Q as M}from"./use-fullscreen-lx1jE9zt.js";import{Q as D}from"./QForm-BA9sEay7.js";import{Q as G}from"./QPage-DgI7XAAt.js";import{u as z}from"./productStore-kIAXihmZ.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QChip-Yh1JQf5n.js";import"./selection-DvxNEaLR.js";import"./format-fzmVlmdj.js";import"./QTooltip-Bxy5RpnE.js";const O={class:"q-pa-md"},T={class:"row q-col-gutter-md"},$={class:"col-xs-12 col-md-8"},j={key:0,class:"q-mt-sm"},J={class:"col-xs-12 col-md-4"},K={class:"q-mt-xl"},W={class:"q-mt-md row q-gutter-md"},X={class:"q-mt-lg"},Y={__name:"ProductCreatePage",setup(Z){const V=C(),P=h(),v=z(),a=s({name:"",reference:"",description:"",category_id:null,price:0,stock_quantity:0,is_active:!0}),u=s(null),d=s(null),i=s([]),n=s([]),y=s([]),g=s(!1);F(async()=>{await v.fetchCategories(),y.value=v.categories.map(o=>({label:o.name,value:o.id}))});const w=o=>{if(u.value=o,o){const l=new FileReader;l.onload=e=>{d.value=e.target.result},l.readAsDataURL(o)}else d.value=null},U=o=>{i.value=o,o&&o.length>0?(n.value=[],o.forEach(l=>{const e=new FileReader;e.onload=f=>{n.value.push(f.target.result)},e.readAsDataURL(l)})):n.value=[]},k=async()=>{g.value=!0;try{await v.createProduct(a.value,u.value,i.value),V.notify({color:"positive",message:"Producto creado exitosamente.",icon:"check_circle"}),P.push({name:"product-list"})}catch(o){console.error("Error al crear el producto:",o),V.notify({color:"negative",message:"Hubo un error al crear el producto. "+(o.message||"Por favor, intente de nuevo."),icon:"error"})}finally{g.value=!1}};return(o,l)=>(m(),b(G,{padding:""},{default:c(()=>[r("div",O,[l[10]||(l[10]=r("div",{class:"text-h4 q-mb-md"},"Crear Nuevo Producto",-1)),t(S,null,{default:c(()=>[t(B,null,{default:c(()=>[t(D,{onSubmit:R(k,["prevent"])},{default:c(()=>[r("div",T,[r("div",$,[t(p,{modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.name=e),label:"Nombre del Producto",filled:"",rules:[e=>!!e||"El nombre es requerido"]},null,8,["modelValue","rules"]),t(p,{modelValue:a.value.reference,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.reference=e),label:"Referencia",filled:"",class:"q-mt-md"},null,8,["modelValue"]),t(x,{modelValue:u.value,"onUpdate:modelValue":[l[2]||(l[2]=e=>u.value=e),w],label:"Avatar del Producto",filled:"",accept:"image/*",capture:"camera",class:"q-mt-md",style:{"max-width":"300px"}},null,8,["modelValue"]),d.value?(m(),q("div",j,[t(Q,{src:d.value,style:{width:"120px",height:"120px","border-radius":"4px"}},null,8,["src"])])):A("",!0),t(L,{modelValue:a.value.description,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.description=e),label:"Descripción",filled:"",class:"q-mt-md","min-height":"150px"},null,8,["modelValue"])]),r("div",J,[t(M,{modelValue:a.value.category_id,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value.category_id=e),options:y.value,label:"Categoría","emit-value":"","map-options":"",filled:"",rules:[e=>e!==null||"La categoría es requerida"]},null,8,["modelValue","options","rules"]),t(p,{modelValue:a.value.price,"onUpdate:modelValue":l[5]||(l[5]=e=>a.value.price=e),modelModifiers:{number:!0},label:"Precio",type:"number",step:"0.01",filled:"",class:"q-mt-md"},null,8,["modelValue"]),t(p,{modelValue:a.value.stock_quantity,"onUpdate:modelValue":l[6]||(l[6]=e=>a.value.stock_quantity=e),modelModifiers:{number:!0},label:"Cantidad en Stock",type:"number",filled:"",class:"q-mt-md"},null,8,["modelValue"]),t(E,{modelValue:a.value.is_active,"onUpdate:modelValue":l[7]||(l[7]=e=>a.value.is_active=e),label:"Producto Activo",class:"q-mt-md"},null,8,["modelValue"])])]),r("div",K,[l[9]||(l[9]=r("div",{class:"text-h6"},"Galería de Imágenes",-1)),t(x,{modelValue:i.value,"onUpdate:modelValue":[l[8]||(l[8]=e=>i.value=e),U],label:"Añadir imágenes a la galería",multiple:"",accept:"image/*",filled:"",capture:"camera",style:{"max-width":"400px"}},null,8,["modelValue"]),r("div",W,[(m(!0),q(N,null,I(n.value,(e,f)=>(m(),b(Q,{key:f,src:e,class:"gallery-thumbnail"},null,8,["src"]))),128))])]),r("div",X,[t(_,{label:"Guardar Producto",type:"submit",color:"primary",loading:g.value},null,8,["loading"]),t(_,{label:"Cancelar",color:"grey",class:"q-ml-sm",to:{name:"product-list"}})])]),_:1})]),_:1})]),_:1})])]),_:1}))}},ce=H(Y,[["__scopeId","data-v-dcf771c0"]]);export{ce as default};
